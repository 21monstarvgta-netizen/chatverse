<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ChatVerse โ ะงะตัะตะผััะบะธ</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css?v=5">
  <link rel="stylesheet" href="/css/game.css?v=5">
</head>
<body>
  <div id="toast-container" class="toast-container"></div>

  <div id="game-loading" class="game-loading">
    <div class="game-loading-content">
      <div class="game-loading-icon">๐๏ธ</div>
      <h2>ะงะตัะตะผััะบะธ</h2>
      <p>ะะฐะณััะทะบะฐ ะฒะฐัะตะณะพ ะณะพัะพะดะฐ...</p>
      <div class="spinner"></div>
    </div>
  </div>

  <div id="game-app" class="game-app hidden">
    <!-- Top Resource Bar -->
    <div class="game-topbar">
      <div class="topbar-left">
  <button class="game-back-btn" id="game-back-btn">โ ะงะฐั</button>
  <div class="city-name-wrapper">
    <span id="city-name" class="city-name">ะะพะน ะณะพัะพะด</span>
    <button class="city-rename-btn" id="city-rename-btn" title="ะะตัะตะธะผะตะฝะพะฒะฐัั">โ๏ธ</button>
    <button class="city-rename-btn" id="game-reset-btn" title="ะกะฑัะพั ะฟัะพะณัะตััะฐ">๐</button>
  </div>
</div>
      <div class="topbar-right">
        <div class="topbar-level">
          <span class="level-badge" id="level-badge">ะฃั. 1</span>
          <div class="xp-bar-mini">
            <div class="xp-bar-fill" id="xp-bar-fill" style="width:0%"></div>
          </div>
        </div>
        <button class="game-center-btn" id="game-center-btn" title="ะ ัะตะฝัั">๐</button>
      </div>
    </div>

    <div class="game-resources-bar" id="resources-bar">
      <div class="res-item" title="ะะพะฝะตัั"><span class="res-icon">๐ช</span><span id="res-coins">0</span></div>
      <div class="res-item" title="ะะดะฐ"><span class="res-icon">๐</span><span id="res-food">0</span></div>
      <div class="res-item" title="ะะฐัะตัะธะฐะปั"><span class="res-icon">๐ชจ</span><span id="res-materials">0</span></div>
      <div class="res-item" title="ะญะฝะตัะณะธั"><span class="res-icon">โก</span><span id="res-energy">0/0</span></div>
      <div class="res-item" title="ะะฐัะตะปะตะฝะธะต"><span class="res-icon">๐ฅ</span><span id="res-population">0</span></div>
      <div class="res-item" title="ะัะธััะฐะปะปั (ะฝะฐะถะผะธ ะดะปั ะพะฑะผะตะฝะฐ)" onclick="game && game.showCrystalExchange()" style="cursor:pointer;" ><span class="res-icon">๐</span><span id="res-crystals">0</span><span style="font-size:10px;opacity:0.6;">โ</span></div>
    </div>

    <!-- Main Game Area -->
    <div class="game-viewport" id="game-viewport">
      <canvas id="game-canvas"></canvas>
    </div>

    <!-- Placing mode banner -->
    <div class="placing-banner hidden" id="placing-banner">
      <span>๐ ะัะฑะตัะธัะต ะบะปะตัะบั ะดะปั ัััะพะธัะตะปัััะฒะฐ</span>
      <button class="btn btn-secondary btn-sm" id="cancel-placing">โ ะัะผะตะฝะฐ</button>
    </div>


    <!-- Move building banner -->
    <div class="placing-banner hidden" id="move-banner" style="background: linear-gradient(135deg, #fdcb6e, #e17055);">
      <span>๐๏ธ ะัะฑะตัะธัะต ะฝะพะฒะพะต ะผะตััะพ ะดะปั ะทะดะฐะฝะธั</span>
      <button class="btn btn-secondary btn-sm" onclick="game.cancelMoving()">โ ะัะผะตะฝะฐ</button>
    </div>
    <!-- Building Info Panel -->
    <div class="building-info-panel hidden" id="building-info-panel">
      <div class="building-info-header">
        <span id="building-info-emoji" class="building-info-emoji">๐</span>
        <div>
          <h3 id="building-info-name">ะะดะฐะฝะธะต</h3>
          <span id="building-info-level" class="building-info-level">ะฃั. 1</span>
        </div>
        <button class="panel-close" id="close-building-info">โ</button>
      </div>
      <div class="building-info-body">
        <div id="building-info-output" class="building-info-row"></div>
        <div id="building-info-timer" class="building-info-row"></div>
        <div class="building-info-actions" id="building-info-actions"></div>
      </div>
    </div>

    <!-- Bottom Build Menu -->
    <div class="game-bottom-bar">
      <button class="bottom-tab active" data-tab="build" id="tab-build">๐๏ธ ะกััะพะธัั</button>
      <button class="bottom-tab" data-tab="quests" id="tab-quests">๐ ะะฒะตััั<span class="quest-badge hidden" id="quest-badge">0</span></button>
      <button class="bottom-tab" data-tab="social" id="tab-social">๐ ะะพัะพะดะฐ</button>
      <button class="bottom-tab" data-tab="collect" id="tab-collect">๐ฐ ะกะพะฑัะฐัั</button>
    </div>

    <!-- Build Panel -->
    <div class="game-panel" id="panel-build">
      <div class="panel-header">
        <h3>๐๏ธ ะะพัััะพะธัั</h3>
        <button class="panel-close" id="close-build-panel">โ</button>
      </div>
      <div class="build-categories" id="build-categories">
        <button class="build-cat-btn active" data-cat="all">ะัะต</button>
        <button class="build-cat-btn" data-cat="production">ะะตััััั</button>
        <button class="build-cat-btn" data-cat="residential">ะะธะปัั</button>
        <button class="build-cat-btn" data-cat="commercial">ะะธะทะฝะตั</button>
        <button class="build-cat-btn" data-cat="infrastructure">ะะฝััะฐ</button>
        <button class="build-cat-btn" data-cat="special">ะัะพะฑัะต</button>
        <button class="build-cat-btn" data-cat="decoration">ะะตะบะพั</button>
      </div>
      <div class="build-list" id="build-list"></div>
    </div>

    <!-- Quests Panel -->
    <div class="game-panel hidden" id="panel-quests">
      <div class="panel-header">
        <h3>๐ ะะฒะตััั</h3>
        <button class="panel-close" id="close-quests-panel">โ</button>
      </div>
      <div class="quests-list" id="quests-list"></div>
    </div>

    <!-- Social Panel -->
    <div class="game-panel hidden" id="panel-social">
      <div class="panel-header">
        <h3>๐ ะะพัะพะดะฐ ะธะณัะพะบะพะฒ</h3>
        <button class="panel-close" id="close-social-panel">โ</button>
      </div>
      <div class="leaderboard-list" id="leaderboard-list"></div>
    </div>

    <!-- Zone unlock modal -->
    <div class="zone-unlock-modal hidden" id="zone-unlock-modal">
      <div class="zone-unlock-content">
        <h3>๐บ๏ธ ะัะบัััั ัะตััะธัะพัะธั</h3>
        <p id="zone-unlock-info"></p>
        <div class="zone-unlock-actions">
          <button class="btn btn-secondary btn-sm" id="zone-cancel">ะัะผะตะฝะฐ</button>
          <button class="btn btn-primary btn-sm" id="zone-confirm" style="width:auto;">ะัะบัััั</button>
        </div>
      </div>
    </div>


    <!-- Crystal Exchange Modal -->
    <div class="zone-unlock-modal hidden" id="crystal-exchange-modal">
      <div class="zone-unlock-content">
        <h3>๐ ะะฑะผะตะฝ ะบัะธััะฐะปะปะพะฒ</h3>
        <p style="color:#a29bfe;">1 ๐ ะบัะธััะฐะปะป = 100 ะปัะฑะพะณะพ ัะตััััะฐ</p>
        <p>ะะฐัะธ ะบัะธััะฐะปะปั: <strong id="crystal-exchange-have">0</strong> ๐</p>
        <div style="margin:10px 0;">
          <label style="color:var(--text-muted);font-size:13px;">ะะพะปะธัะตััะฒะพ ะบัะธััะฐะปะปะพะฒ:</label><br>
          <input type="number" id="crystal-amount" min="1" value="1" style="width:100%;padding:8px;border-radius:8px;border:1px solid var(--border);background:var(--surface);color:var(--text);margin-top:4px;" oninput="game.updateCrystalExchangePreview()">
        </div>
        <div style="margin:10px 0;">
          <label style="color:var(--text-muted);font-size:13px;">ะะพะปััะธัั ัะตัััั:</label><br>
          <select id="crystal-resource" style="width:100%;padding:8px;border-radius:8px;border:1px solid var(--border);background:var(--surface);color:var(--text);margin-top:4px;" onchange="game.updateCrystalExchangePreview()">
            <option value="coins">๐ช ะะพะฝะตัั</option>
            <option value="food">๐ ะะดะฐ</option>
            <option value="materials">๐ชจ ะะฐัะตัะธะฐะปั</option>
          </select>
        </div>
        <div id="crystal-exchange-preview" style="text-align:center;font-size:16px;font-weight:bold;color:#55efc4;margin:12px 0;">1 ๐ โ 100 ๐ช</div>
        <div class="zone-unlock-actions">
          <button class="btn btn-secondary btn-sm" onclick="document.getElementById('crystal-exchange-modal').classList.add('hidden')">ะัะผะตะฝะฐ</button>
          <button class="btn btn-primary btn-sm" style="width:auto;" onclick="game.confirmCrystalExchange()">๐ ะะฑะผะตะฝััั</button>
        </div>
      </div>
    </div>
    <!-- Visit mode banner -->
    <div class="visit-banner hidden" id="visit-banner">
      <span id="visit-banner-text">ะัะพัะผะพัั ะณะพัะพะดะฐ</span>
      <button class="btn btn-secondary btn-sm" id="visit-back">โ ะะพะน ะณะพัะพะด</button>
    </div>
  </div>

  <script src="/js/utils.js?v=6"></script>
  <script src="/js/gameRenderer.js?v=6"></script>
  <script src="/js/gameUI.js?v=6"></script>
  <script src="/js/game.js?v=6"></script>
</body>
</html>