<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ChatVerse</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen" class="loading-screen">
    <div class="spinner"></div>
    <p>–ó–∞–≥—Ä—É–∑–∫–∞ ChatVerse...</p>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="toast-container"></div>

  <!-- Mobile sidebar overlay -->
  <div id="sidebar-overlay" class="sidebar-overlay"></div>

  <!-- Main Chat Layout -->
  <div id="chat-app" class="chat-layout hidden">
    
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <div class="logo-mini">üí¨</div>
          <h2>ChatVerse</h2>
        </div>
        <div class="sidebar-header-actions">
          <button class="btn-icon" id="btn-profile" title="–ü—Ä–æ—Ñ–∏–ª—å">üë§</button>
          <button class="btn-icon" id="btn-logout" title="–í—ã–π—Ç–∏">üö™</button>
        </div>
      </div>

      <!-- Navigation -->
      <nav class="sidebar-nav">
        <button class="nav-item active" id="nav-general" data-view="general">
          <span class="nav-icon">üåç</span>
          <span>–û–±—â–∏–π —á–∞—Ç</span>
        </button>
      </nav>

      <!-- Rooms -->
      <div class="sidebar-section">
        <div class="section-header">
          <h3>–ö–æ–º–Ω–∞—Ç—ã</h3>
          <button id="btn-create-room" title="–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É">‚ûï</button>
        </div>
        <div id="rooms-list">
          <!-- Rooms will be inserted here -->
        </div>
      </div>

      <!-- User Profile Mini -->
      <div class="sidebar-profile" id="sidebar-user-profile">
        <!-- Will be filled by JS -->
      </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="chat-main">
      <!-- Chat Header -->
      <header class="chat-header">
        <div class="chat-header-info">
          <button class="mobile-menu-btn" id="mobile-menu-btn">‚ò∞</button>
          <div>
            <h2 id="chat-title">üåç –û–±—â–∏–π —á–∞—Ç</h2>
            <span class="online-count" id="online-count">0 –æ–Ω–ª–∞–π–Ω</span>
          </div>
        </div>
        <div class="chat-header-actions" id="chat-header-actions">
          <!-- Room actions will appear here -->
        </div>
      </header>

      <!-- Messages -->
      <div class="messages-container" id="messages-container">
        <div class="empty-state" id="empty-messages">
          <div class="empty-icon">üí¨</div>
          <h3>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
          <p>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –Ω–∞–ø–∏—à–µ—Ç!</p>
        </div>
      </div>

      <!-- Typing Indicator -->
      <div class="typing-indicator" id="typing-indicator"></div>

      <!-- Message Input -->
      <div class="message-input-area">
        <div class="message-input-wrapper">
          <textarea 
            class="message-input" 
            id="message-input" 
            placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ..."
            rows="1"
            maxlength="2000"
          ></textarea>
          <button class="send-btn" id="send-btn" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">
            ‚û§
          </button>
        </div>
      </div>
    </main>

    <!-- Online Users Panel -->
    <aside class="online-panel" id="online-panel">
      <div class="online-panel-header">
        <h3>
          –û–Ω–ª–∞–π–Ω
          <span class="count" id="online-panel-count">0</span>
        </h3>
      </div>
      <div class="online-users-list" id="online-users-list">
        <!-- Online users will be inserted here -->
      </div>
    </aside>
  </div>

  <!-- Create Room Modal -->
  <div id="create-room-modal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h2>–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h2>
        <button class="modal-close" id="close-create-room">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã</label>
          <input type="text" class="form-input no-icon" id="room-name-input" placeholder="–ú–æ—è –∫–æ–º–Ω–∞—Ç–∞" maxlength="50">
        </div>
        <div class="form-group">
          <label>–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
          <input type="text" class="form-input no-icon" id="room-desc-input" placeholder="–û —á—ë–º —ç—Ç–∞ –∫–æ–º–Ω–∞—Ç–∞" maxlength="200">
        </div>
        <div class="form-group">
          <label>–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</label>
          <div class="search-input-wrapper">
            <span class="search-icon">üîç</span>
            <input type="text" id="member-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...">
          </div>
          <div class="users-checkbox-list" id="members-checkbox-list">
            <!-- Users will be loaded here -->
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancel-create-room">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" style="width:auto" id="confirm-create-room">–°–æ–∑–¥–∞—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- Room Info Modal -->
  <div id="room-info-modal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h2 id="room-info-title">–ö–æ–º–Ω–∞—Ç–∞</h2>
        <button class="modal-close" id="close-room-info">‚úï</button>
      </div>
      <div class="modal-body">
        <p id="room-info-desc" style="color: var(--text-secondary); margin-bottom: 16px;"></p>
        <h3 style="font-size: 14px; color: var(--text-muted); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px;">–£—á–∞—Å—Ç–Ω–∏–∫–∏</h3>
        <div id="room-members-list" class="users-checkbox-list" style="max-height: 400px;">
          <!-- Members list -->
        </div>
        <div id="room-admin-actions" class="mt-4" style="display: flex; gap: 8px; flex-wrap: wrap;">
          <!-- Admin actions -->
        </div>
      </div>
    </div>
  </div>

  <!-- Add Member Modal -->
  <div id="add-member-modal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h2>–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞</h2>
        <button class="modal-close" id="close-add-member">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="search-input-wrapper">
          <span class="search-icon">üîç</span>
          <input type="text" id="add-member-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...">
        </div>
        <div class="users-checkbox-list" id="add-members-list">
          <!-- Users -->
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancel-add-member">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-primary" style="width:auto" id="confirm-add-member">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- User Popup -->
  <div id="user-popup" class="user-popup hidden"></div>

  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script src="/js/utils.js"></script>
  <script src="/js/chat.js"></script>
  <script src="/js/rooms.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>